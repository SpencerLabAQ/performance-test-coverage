
# An Empirical Study on Performance Test Coverage: Replication Package

This repository contains the replication package for the paper "*An Empirical Study on Performance Test Coverage*". It includes all necessary scripts and instructions to replicate the experiments and analyses presented in the paper.

## Requirements

- Python 3.10.5
- [Additional dependencies are listed in the `requirements.txt` file](requirements.txt)

Use the following commands to install Python dependencies:
```
pip install --upgrade pip
pip install -r requirements.txt
```

## Directory Structure and Descriptions

- A comprehensive guide providing all necessary instructions and descriptions to understand and replicate the analyses.


### Data Collection Instructions
In order to collect the callstacks that will be used to determine the coverage of methods, we leverage [async-profiler](https://github.com/async-profiler/async-profiler).

Specifically, given a [self-contained executable JAR of JMH](https://github.com/openjdk/jmh) `benchmarks.jar`, we run the following command to collect the methods invoked by each benchmark:

```
java -jar benchmarks.jar -bm avgt -wi 0 -i 1 -f 1 -r 100ms -foe false -jvmArgsPrepend "-agentpath:{ASYNC_PROFILER_PATH}/build/libasyncProfiler.so=start,event=cpu,collapsed,cstack=no,include=*jmh*,file=.%t.folded,interval=1"
``````

Similarly, for JUnit we run:

```
mvn test -DargLine="-agentpath:{ASYNC_PROFILER_PATH}/build/libasyncProfiler.so=start,event=cpu,collapsed,cstack=no,include=*junit*,file=.%t.folded,interval=1"
```


### analysis/
Scripts in this directory perform overlap and test coverages analysis.
- `1-Overlap-JMH.py`
- `2-Overlap-JUnit.py`
- `3-Coverage-JMH.py`
- `4-Coverage-JUnit.py`
   - Run these scripts in sequence to generate intermediate outputs for further analyses and to answer research questions 1 and 2.

### analysis/plots_tables_scripts/
Scripts for generating plots and tables related to the research questions.
- Run these scripts after executing the main analysis scripts (`1-Overlap-JMH.py`, `2-Overlap-JUnit.py`, `3-Coverage-JMH.py`, `4-Coverage-JUnit.py`).

### figures/
Contains output figures from the analysis scripts. Each figure is related to specific research questions, as indicated in the filenames.

### inputs/
Contains all necessary input data for performing test overlap and coverage analysis.
- `Project_Meta_Info.csv`: Metadata including GitHub stars information for each project.
- Subdirectories such as `benchmarks/`, `methods/`, and `unit_tests/` contain collected data used in the analysis.

### outputs/
Contains intermediate outputs generated by the main analysis scripts (`1-Overlap-JMH.py`, `2-Overlap-JUnit.py`, `3-Coverage-JMH.py`, `4-Coverage-JUnit.py`).

### tables/
Contains generated tables as outputs from the analysis scripts.

## Execution Instructions

1. **Running Analysis Scripts:**
   - Navigate to the `analysis/` directory.
   - Run the scripts in sequence:
     ```
     python 1-Overlap-JMH.py
     python 2-Overlap-JUnit.py
     python 3-Coverage-JMH.py
     python 4-Coverage-JUnit.py
     ```

2. **Generating Plots and Tables:**
   - Navigate to the `analysis/plots_tables_scripts/` directory.
   - Run the scripts to generate plots and tables. Below are the commands to execute each script:
   ```bash
   python rq1-fig3.py
   python rq1-fig4.py
   python rq1-fig5.py
   python rq1-table_II.py
   python rq2-fig6.py
   python rq2-fig7.py
   python rq2-fig8.py
   python rq2-fig9.py
   python rq3-fig10.py
   python rq3-fig11.py
   python rq4-fig12.py
   python rq4-fig13.py
   ```

3. **Viewing Results:**
   - Check the `figures/` and `tables/` directories for output figures and tables.
   - Intermediate results can be found in the `outputs/` directory.
